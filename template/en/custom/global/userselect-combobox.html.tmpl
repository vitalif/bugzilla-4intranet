[%# The contents of this file are subject to the Mozilla Public
  # License Version 1.1 (the "License"); you may not use this file
  # except in compliance with the License. You may obtain a copy of
  # the License at http://www.mozilla.org/MPL/
  #
  # Software distributed under the License is distributed on an "AS
  # IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or
  # implied. See the License for the specific language governing
  # rights and limitations under the License.
  #
  # The Original Code is the Bugzilla Bug Tracking System.
  #
  # Contributor(s): Byron Jones <bugzilla@glob.com.au>
  #                 Frédéric Buclin <LpSolit@gmail.com>
  #%]

[%# INTERFACE:
  # name: mandatory; field name
  # id: optional; field id
  # value: optional; default field value/selection
  # onchange: optional; onchange attribute value
  # disabled: optional; if true, the field is disabled
  # accesskey: optional, input only; accesskey attribute value
  # emptyok: optional, select only;  if true, prepend menu option to start of select
  # multiple: optional, do multiselect
  # custom_userlist: optional, specify a limited list of users to use
  #%]

<div style="position: relative">
[% SET id="userselect_" _ name IF !id %]
[% SET emptyok=emptyok ? 1 : 0 %]
[% SET custom_userlist=user.get_userlist UNLESS custom_userlist %]
[% UNLESS multiple %]
<div class="selectfree_ie" style="position:absolute;top:1px;left:1px;z-index:20;overflow:hidden">
<input
  name="[% name | html %]"
  value="[% value | html %]"
  [% IF disabled %] disabled="[% disabled | html %]" [% END %]
  [% IF accesskey %] accesskey="[% accesskey | html %]" [% END %]
  id="[% id | html %]"
  onchange="menuforusers_tocombo('[% id | js %]', 0); [% onchange | html %]" />[% IF multiple %]<img style="margin-bottom:-4px" src="images/dn.gif" alt="dropdown list" title="dropdown list" onclick="menuforusers_showmulti('[% id | js %]')" />[% END %]
[%# http://anton-egorov.blogspot.com/2007/11/ie-select-z-index.html %]
<!--[if lte IE 6.5]><iframe style="width: 800px; height: 200px;"></iframe><![endif]-->
</div>
<select style="top: 0; left: 0; position: relative; z-index: 10"
  id="[% id | html %]_s"
  [% IF disabled %] disabled="[% disabled | html %]" [% END %]
  onchange="menuforusers_fromcombo('[% id | js %]', 0)"
>
  [% IF emptyok %]<option value=""></option>[% END %]
  [% FOREACH tmpuser = custom_userlist %]
    <option value="[% tmpuser.login | html %]">[% tmpuser.identity | html %]</option>
  [% END %]
</select>
[% ELSE %]
<div style="border: 1px solid gray; display: inline-block">
<input
  name="[% name | html %]"
  value="[% value | html %]"
  [% IF disabled %] disabled="[% disabled | html %]" [% END %]
  [% IF accesskey %] accesskey="[% accesskey | html %]" [% END %]
  id="[% id | html %]" style="height: 19px; padding: 0; margin: 0"
  onchange="menuforusers_tocombo('[% id | js %]', 1); [% onchange | html %]" /><img id="[% id | html %]_b" style="margin-bottom:-4px" src="images/dn.gif" alt="dropdown list" title="dropdown list" />
<div class="selectfree_ie" style="position:relative:z-index:30;overflow:hidden">
<select id="[% id | html %]_s"
    [% IF disabled %] disabled="[% disabled | html %]" [% END %]
    onchange="menuforusers_fromcombo('[% id | js %]', 1)" multiple="multiple" size="[% custom_userlist.size+emptyok < 4 ? custom_userlist.size+emptyok : 4 %]"
    style="position:absolute;visibility:hidden">
  [% IF emptyok %]<option value=""></option>[% END %]
  [% FOREACH tmpuser = custom_userlist %]
    <option value="[% tmpuser.login | html %]">[% tmpuser.identity | html %]</option>
  [% END %]
</select>
</div>
</div>
[% END %]
<script language="JavaScript">
YAHOO.util.Event.addListener(window, "load", function() { menuforusers_initcombo("[% id | js %]", [% multiple ? 1 : 0 %]) }, null);
</script>
</div>
